<!DOCTYPE html>
<html>
<head>

</head>
<body onload="Init()">

<button id="startBtn" style="padding: 10px 20px; font-size: 16px; margin-bottom: 10px;">Start Game</button>

<canvas id="myCanvas" width="900" height="700"
style="border:1px solid #d3d3d3;">
Your browser does not support the HTML5 canvas tag.</canvas>

<script>
	
//////////
//Init
//////////
var canvas;
var ctx;
var player_img;
var player_x = 80;
var player_y = 0;
var player_vy = 0;
var rocketSpeed = 8;

var meteor_img;
var meteor_x = 910;
var meteor_y = 200;

var meteor2_x = 1200;
var meteor2_y = 600;

var meteor3_x = 1600;
var meteor3_y = 400;

var meteor4_x = 1950;
var meteor4_y = 20;

var meteor5_x = 2000;
var meteor5_y = 300;

var meteor_speed = 8 + Math.random() * 4;
var meteor2_speed = 8 + Math.random() * 4;
var meteor3_speed = 8 + Math.random() * 4;
var meteor4_speed = 8 + Math.random() * 4;
var meteor5_speed = 8 + Math.random() * 4;

var rockethit = false;
var bg_img;
var keys = {};
var gameStarted = false;

function Init()
{
	canvas = document.getElementById("myCanvas");
	ctx = canvas.getContext("2d");
	player_img = new Image();
	player_img.src = "images/rocket.png";
	meteor_img = new Image();
	meteor_img.src = "images/meteor.gif"
	bg_img = new Image();
	bg_img.src = "images/space.png"

	meteor_y = Math.random() * (canvas.height - 90);
	meteor2_y = Math.random() * (canvas.height - 90);
	meteor3_y = Math.random() * (canvas.height - 90);
	meteor4_y = Math.random() * (canvas.height - 90);
	meteor5_y = Math.random() * (canvas.height - 90);
}

//set main loop and frame rate
setInterval(MainLoop, 16);
window.addEventListener('keydown', KeyDown);
window.addEventListener('keyup', KeyUp);
document.getElementById('startBtn').addEventListener('click', StartGame);

//////////
//Min loop
//////////
function MainLoop()
{
	if(gameStarted && !rockethit){
		Update();
	}
	Draw();
}

function Update()
{
 if(keys['ArrowUp'] && player_y > 0)
 {
 	player_y -= rocketSpeed;
 }
 if(keys['ArrowDown'] && player_y < canvas.height - 150)
 {
 	player_y += rocketSpeed;
 }

 meteor_x-= meteor_speed;
 if (meteor_x<=0){
	meteor_speed = 8 + Math.random() * 4;
	meteor_y = Math.random() * (canvas.height - 90);
	meteor_x=910
 }
  meteor2_x-= meteor2_speed;
 if (meteor2_x<=0){
	meteor2_speed = 8 + Math.random() * 4;
	meteor2_y = Math.random() * (canvas.height - 90);
	meteor2_x=910
 }

 meteor3_x-= meteor3_speed;
 if (meteor3_x<=0){
	meteor3_speed = 8 + Math.random() * 4;
	meteor3_y = Math.random() * (canvas.height - 90);
	meteor3_x=910
 }
 meteor4_x-= meteor4_speed;
 if (meteor4_x<=0){
	meteor4_speed = 8 + Math.random() * 4;
	meteor4_y = Math.random() * (canvas.height - 90);
	meteor4_x=910
 }
 meteor5_x-= meteor5_speed;
 if (meteor5_x<=0){
	meteor5_speed = 8 + Math.random() * 4;
	meteor5_y = Math.random() * (canvas.height - 90);
	meteor5_x=910
 }

 CheckCollision(meteor_x, meteor_y);
 CheckCollision(meteor2_x, meteor2_y);
 CheckCollision(meteor3_x, meteor3_y);
 CheckCollision(meteor4_x, meteor4_y);
 CheckCollision(meteor5_x, meteor5_y);
}

//////////
//Collision Detection
//////////
function CheckCollision(meteor_x, meteor_y){
 if(player_x + 20 < meteor_x + 40 &&
    player_x + 80 > meteor_x + 10 &&
    player_y + 20 < meteor_y + 40 &&
    player_y + 80 > meteor_y + 10)
 {
  rockethit = true;
  bg_img.src = "images/GameOver.png";
 }
}

//////////
//Draw
//////////
function Draw(){
	
	ctx.clearRect(0,0,canvas.width,canvas.height);
	ctx.drawImage(bg_img,0,0, 900, 900);

	ctx.drawImage(meteor_img, meteor_x,meteor_y,90,90);
	ctx.drawImage(meteor_img, meteor2_x,meteor2_y,90,90);
	ctx.drawImage(meteor_img, meteor3_x,meteor3_y,90,90);
	ctx.drawImage(meteor_img, meteor4_x,meteor4_y,90,90);
	ctx.drawImage(meteor_img, meteor5_x,meteor5_y,90,90);
	ctx.drawImage(player_img,player_x,player_y,150, 150);	
}

//////////
//Events
//////////
function KeyDown(event)
{
	keys[event.key] = true;
}

function KeyUp(event)
{
	keys[event.key] = false;
}

function StartGame()
{
	gameStarted = true;
	document.getElementById('startBtn').disabled = true;
	document.getElementById('startBtn').textContent = 'Game Running...';
}

</script>

</body>
</html>


